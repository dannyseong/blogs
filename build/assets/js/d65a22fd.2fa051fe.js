"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2858],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>u});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=c(n),h=a,u=d["".concat(p,".").concat(h)]||d[h]||m[h]||i;return n?r.createElement(u,o(o({ref:t},l),{},{components:n})):r.createElement(u,o({ref:t},l))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=h;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[d]="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7799:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var r=n(7462),a=(n(7294),n(3905));const i={title:"Action Script and Guestbook Example",tags:["php"],sidebar_label:"9. Action Script and Guestbook Example",sidebar_position:9},o=void 0,s={unversionedId:"PHP/action_script",id:"PHP/action_script",title:"Action Script and Guestbook Example",description:"1. Action Scripts in PHP",source:"@site/docs/PHP/9_action_script.md",sourceDirName:"PHP",slug:"/PHP/action_script",permalink:"/docs/PHP/action_script",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/PHP/9_action_script.md",tags:[{label:"php",permalink:"/docs/tags/php"}],version:"current",sidebarPosition:9,frontMatter:{title:"Action Script and Guestbook Example",tags:["php"],sidebar_label:"9. Action Script and Guestbook Example",sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"8. File Processing",permalink:"/docs/PHP/file_processing"},next:{title:"10. Object Oriented PHP",permalink:"/docs/PHP/syntax_object_oriented"}},p={},c=[{value:"1. Action Scripts in PHP",id:"1-action-scripts-in-php",level:2},{value:"2. Key Points about Action Scripts",id:"2-key-points-about-action-scripts",level:2},{value:"3. Guestbook: One-Component Version Example",id:"3-guestbook-one-component-version-example",level:2},{value:"index.php - Calling Script",id:"indexphp---calling-script",level:3},{value:"add_form.html - Form for Adding Messages",id:"add_formhtml---form-for-adding-messages",level:3},{value:"add_action.php - Action Script",id:"add_actionphp---action-script",level:3},{value:"defs.php - Definitions and Functions",id:"defsphp---definitions-and-functions",level:3}],l={toc:c},d="wrapper";function m(e){let{components:t,...i}=e;return(0,a.kt)(d,(0,r.Z)({},l,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"1-action-scripts-in-php"},"1. Action Scripts in PHP"),(0,a.kt)("p",null,"An essential technique in PHP programming is the use of action scripts, also known as one-components scripts. These scripts serve as a specific purpose: executing a task without requiring a complex user interface. One of their primary applications is performing actions, such as adding items to a shopping cart, and then quickly redirecting the user back to their original page."),(0,a.kt)("h2",{id:"2-key-points-about-action-scripts"},"2. Key Points about Action Scripts"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Concealing Information"),": Action scripts should avoid displaying unnecessary information, focusing solely on executing the requiredd task."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Returning to the Caller"),": These scripts must redirect back to the referring page, even when the referring page's name cannot be hardcoded into the action script."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Updating Server Information"),": Action scripts are ideal for updating server information, such as altering database records."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Avoiding Reload-Redo Issue"),': By separating actions into one-component scripts, the risk of unintentionally repeating server updates when users click the "reload" button can be mitigated.')),(0,a.kt)("h2",{id:"3-guestbook-one-component-version-example"},"3. Guestbook: One-Component Version Example"),(0,a.kt)("p",null,"Here's an example showcasing the use of action scripts in a guestbook application. This application consists of two main components: ",(0,a.kt)("inlineCode",{parentName:"p"},"index.php")," (the calling script) and ",(0,a.kt)("inlineCode",{parentName:"p"},"add_action.php")," (the action script)."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The PHP function ",(0,a.kt)("inlineCode",{parentName:"p"},"header()")," sends its arguments as a response to the HTTP request that caused the current script to be executed. In this case, it redirects control to the script index.php, without returning an HTML response. Calls to the function ",(0,a.kt)("inlineCode",{parentName:"p"},"header()")," must be made before any other output is generated, not even a black line.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Note that this version of the guestbook application does not have the reload-redo problem.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"More generally, we may wish to redirect control back to the referring script, whatever it was. Thi may be done as follow:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-php"},'    // Redirect back to the referring\n    // script\n    $referer = $_SERVER[\'HTTP_REFERER\']";\n    header("Location: $referer");\n    exit;\n'))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Here, the PHP variable ",(0,a.kt)("inlineCode",{parentName:"p"},"$_SERVER['HTTP_REFERER]")," stores the URL of the calling, or referring, script. If this response is the first output of the action script, the effect is to immediately redirect control back to the calling page, which is exactly what is required.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The function ",(0,a.kt)("inlineCode",{parentName:"p"},"header()")," can be used to output other forms of HTTP. There are also many other useful PHP variables like ",(0,a.kt)("inlineCode",{parentName:"p"},"$_SERVER['HTTP_REFERER']"),", for example, ",(0,a.kt)("inlineCode",{parentName:"p"},"$_SERVER['PHP_SELF']")," which is the name of the current script.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Note again that the function ",(0,a.kt)("inlineCode",{parentName:"p"},"header()")," must be called before anything (even a blank line) is output by the script.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"It is good practice to use a one-component (or script) to process form data whenever the form uses method ",(0,a.kt)("inlineCode",{parentName:"p"},"POST"),'. Otherwise, there is a risk of incorrectly repeating the server update operation when the "reload" button in the browser is pressed.')),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Hence, one-component scripts are very frequently required."))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"diagram for actino scripting",src:n(5015).Z,width:"668",height:"566"})),(0,a.kt)("h3",{id:"indexphp---calling-script"},"index.php - Calling Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},'<!DOCTYPE html>\n<html>\n<head>\n    <title>My Guest Book</title>\n    <meta charset="utf-8">\n</head>\n<body>\n<h1>My Guest Book</h1>\n\n<?php\ninclude "includes/defs.php";\nshowEntries();\n?>\n\n<a href="add_form.html">Add your own message</a>\n\n</body>\n</html>\n')),(0,a.kt)("h3",{id:"add_formhtml---form-for-adding-messages"},"add_form.html - Form for Adding Messages"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- add_form.html --\x3e\n<!DOCTYPE html>\n\x3c!-- Add new entry form. --\x3e\n<html>\n  <head>\n    <title>Guest Book Message Entry</title>\n    <meta charset="utf-8" />\n  </head>\n  <body>\n    <h1>Message Entry Form</h1>\n    <form method="post" action="add_action.php">\n      \x3c!-- From fields here --\x3e\n    </form>\n  </body>\n</html>\n')),(0,a.kt)("h3",{id:"add_actionphp---action-script"},"add_action.php - Action Script"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},'<?php\ninclude "includes/defs.php";\n\n$message = $_POST[\'message\'];\n$author = $_POST[\'author\'];\n\nif (!empty($message)) {\n    // Add new message from form data\n    if (empty($author)) {\n        $author = "Anon.";\n    }\n    writeEntry($message, $author);\n\n    // Redirect to home page\n    $referer = $_SERVER[\'HTTP_REFERER\'];\n    header("Location: $referer");\n    exit;\n} else {\n    echo "<p>Error: Empty message in form data.</p>\\n";\n}\n?>\n')),(0,a.kt)("h3",{id:"defsphp---definitions-and-functions"},"defs.php - Definitions and Functions"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n/* Constant and function definitions for simple guest book application. */\n\ndefine("FILE","messages.txt");\n\n/* Appends entry to FILE. */\nfunction writeEntry($message, $author) {\n  $fp = fopen(FILE, "a");\n  fwrite($fp, "$message\\n");\n  fwrite($fp, "$author\\n");\n  fclose($fp);\n}\n\n/*\n * Shows entries in FILE\n * PHP blocks are not interpreted on the server,\n * and HTML and JavaScript elements are not interpreted on the client.\n */\nfunction showEntries() {\n  $fp = fopen(FILE, "r");\n  if ( $fp ) {                      # added by Anthony Thyssen 21/02/2014\n    $n = 0;\n    while ($fp && !feof($fp)) {\n      $message = fgets($fp, 4096);\n      if (!empty($message) && !feof($fp)) { # should not be necessary!\n        $message = htmlspecialchars($message);\n        $author = htmlspecialchars(trim(fgets($fp, 4096)));\n        echo "<p>$message</p>\\n";\n        echo "<p>-- $author</p>\\n";\n\n        $n++;\n      }\n    }\n    echo "<p>(Debugging: No. messages = $n.)</p>\\n";\n    fclose($fp);\n  }\n}\n?>\n')),(0,a.kt)("p",null,"This example demonstrates the flow of an action script in the context of a guestbook application. Users can add messages through a form, and the action script adds the message to the guestbook while ensuring a smooth redirection back to the referring page."))}m.isMDXComponent=!0},5015:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/3-e5d5abfac258a4036cc326f6081110e9.png"}}]);